import{j as e,r,m as ne,b as C,d as h,n as de,c as G,R as ie,u as ce,g as V,a as T,e as he,l as ue,o as _,f as xe}from"./index-H1kLPFNU.js";import{G as u,I as $}from"./index-Dmyz76UT.js";import{I as B}from"./Input-C0M9PrMI.js";function pe(t){return u({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z"},child:[]}]})(t)}function A(t){return u({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"},child:[]}]})(t)}function me(t){return u({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"},child:[]}]})(t)}function ge({handleSidePanelArrow:t,showSidePanel:a,addNewStudent:c,showPendingUsers:n}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:` [direction:rtl] flex flex-col items-center fixed lg:right-0 top-30 rounded px-10 py-5 bg-n2-color sm:w-[40%] md:w-[32%] lg:w-[25%] transition-all duration-300 ease-in-out ${a?"right-0 sm:right-0":"right-[-238px]"}`,children:[e.jsxs("div",{className:"flex flex-col gap-3 text-title-color font-bold",children:[e.jsxs("button",{className:"flex gap-3 cursor-pointer px-3 py-2 bg-bg2-color rounded",onClick:c,children:[e.jsx(me,{size:20,color:"green"}),"إضافة طالب جديد"]}),e.jsxs("button",{className:"flex gap-3 cursor-pointer px-3 py-2 bg-bg2-color rounded",onClick:n,children:[e.jsx(pe,{size:20,color:"blue"}),"عرض الحسابات"]})]}),e.jsx("div",{className:"bg-white shadow-md rounded-full md: absolute left-[-42px] top-[40px] w-[29px] h-[30px] p-5 cursor-pointer lg:hidden",onClick:t,children:e.jsx("div",{className:`size-5 relative top-[-10px]
        border-[3px] border-t-0 border-r-0 border-l-p-color border-b-p-color 
        rounded-tr-none transition-all duration-300 ease-in-out ${a?"rotate-[220deg] left-[7px]":"rotate-[40deg] left-[15px]"}`})})]})})}function F(t){return u({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"m7 17.013 4.413-.015 9.632-9.54c.378-.378.586-.88.586-1.414s-.208-1.036-.586-1.414l-1.586-1.586c-.756-.756-2.075-.752-2.825-.003L7 12.583v4.43zM18.045 4.458l1.589 1.583-1.597 1.582-1.586-1.585 1.594-1.58zM9 13.417l6.03-5.973 1.586 1.586-6.029 5.971L9 15.006v-1.589z"},child:[]},{tag:"path",attr:{d:"M5 21h14c1.103 0 2-.897 2-2v-8.668l-2 2V19H8.158c-.026 0-.053.01-.079.01-.033 0-.066-.009-.1-.01H5V5h6.847l2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2z"},child:[]}]})(t)}function fe(t){return u({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16 13v-2H7V8l-5 4 5 4v-3z"},child:[]},{tag:"path",attr:{d:"M20 3h-9c-1.103 0-2 .897-2 2v4h2V5h9v14h-9v-4H9v4c0 1.103.897 2 2 2h9c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2z"},child:[]}]})(t)}function be(t){return u({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"},child:[]}]})(t)}function ve(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 7l16 0"},child:[]},{tag:"path",attr:{d:"M10 11l0 6"},child:[]},{tag:"path",attr:{d:"M14 11l0 6"},child:[]},{tag:"path",attr:{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"},child:[]},{tag:"path",attr:{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"},child:[]}]})(t)}function we({students:t=[],handelDelete:a,handelEdit:c}){return e.jsxs("div",{className:"w-[100%] sm:w-[90%] lg:w-3/4 bg-bg2-color rounded overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-1 sm:gap-4 text-center font-bold py-2 [&_div]:p-2 bg-n3-color  ",children:[e.jsx("div",{className:"bg--color",children:"No"}),e.jsx("div",{children:"Student Id"}),e.jsx("div",{children:"Student Name"}),e.jsx("div",{children:"Grade"})]}),t.map((n,m)=>e.jsxs("div",{className:" grid grid-cols-5 gap-1 sm:gap-4 text-center py-2 pr-5 border-b items-center",children:[e.jsx("div",{children:++m}),e.jsx("div",{children:n.std_id}),e.jsx("div",{children:n.stdName}),e.jsx("div",{children:n.stdGrade}),e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:"cursor-pointer hover:bg-red-200 w-fit p-3 rounded transition-all duration-300 ease-out",onClick:()=>a(n.id),children:e.jsx(ve,{size:20,color:"red"})}),e.jsx("div",{className:"cursor-pointer hover:bg-blue-200 w-fit p-3 rounded transition-all duration-300 ease-out",onClick:()=>c(n.id),children:e.jsx(F,{size:20,color:"blue"})})]})]},n.id))]})}function R({msg:t}){return e.jsxs("div",{className:"flex items-center gap-2 bg-green-500  w-fit  rounded px-3 py-2 absolute bottom-[-50px] left-0 ",children:[e.jsx(A,{size:25,color:"black"}),t]})}const je=(t,a)=>{switch(a.type){case"stdName":return{...t,stdName:a.newValue};case"std_id":return{...t,std_id:a.newValue};case"stdGrade":return{...t,stdGrade:a.newValue};case"stdCourse":return{...t,stdCourse:a.newValue};case"reset":return{stdName:"",std_id:"",stdGrade:"",stdCourse:""}}};function Ce({closeNewStdForm:t,fetchStudents:a,oldStudent:c,editedId:n}){const m=c||{stdName:"",std_id:"",stdGrade:""},[l,i]=r.useReducer(je,m),[x,k]=r.useState({validateName:null,validateId:null,validateGrade:null,validateCourse:null}),[y,v]=r.useState(!1),[z,j]=r.useState(!1),g=p=>{i({type:"stdName",newValue:p})},L=p=>{i({type:"std_id",newValue:p})},f=p=>{i({type:"stdGrade",newValue:p})},P=async p=>{p.preventDefault();const M=/^\d+$/.test(l.std_id),N=/^[A-Za-z\s]*\d*$/.test(l.stdCourse),D=/^(?:\d{1,3}|[A-F][+-]?)$/.test(l.stdGrade);if(k({validateId:M,validateCourse:N,validateGrade:D}),M&&D){if(n){j(!0);try{await ne(C(h,"grades",n),{stdName:l.stdName,std_id:l.std_id,stdGrade:l.stdGrade})}catch(w){console.log(w)}finally{j(!1),v(!0),setTimeout(()=>{v(!1)},1e3)}}else{try{j(!0),await de(G(h,"grades"),{stdName:l.stdName,std_id:l.std_id,stdGrade:l.stdGrade})}catch(w){console.log(`the error is ${w}`)}finally{j(!1),v(!0),setTimeout(()=>{v(!1)},1e3)}i({type:"reset"})}typeof a=="function"&&a()}};return e.jsxs("form",{onSubmit:P,className:"fixed w-[min(80%,550px)] [direction:rtl] flex flex-col gap-3 px-5 py-15 bg-n2-color border-2 border-white rounded top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%]",children:[e.jsx($,{size:50,color:"white",className:"absolute top-0 right-0 cursor-pointer hover:bg-red-500 transition-all duration-300 ease-in-out p-2 rounded",onClick:t}),e.jsx(B,{type:"text",label:"اسم الطالب",value:l.stdName,onChange:g,customStyle:"text-center"}),e.jsx(B,{type:"text",label:"رقم التسجيل",value:l.std_id,onChange:L,customStyle:"text-center"}),e.jsx(B,{type:"text",label:"درجة الطالب",value:l.stdGrade,onChange:f,customStyle:"text-center ![direction:ltr]"}),e.jsx("button",{type:"submit",disabled:z,className:`flex justify-center items-center font-bold  px-3 py-2 w-full rounded bg-green-400  cursor-pointer hover:bg-green-600 hover:text-white transition duration-300 ease-in-out ${z&&"opacity-50"}`,children:n?e.jsxs(e.Fragment,{children:[e.jsx(F,{size:25}),"تعديل"," "]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{size:25}),"إضافة"]})}),y&&e.jsx(R,{msg:" تم الإضافة بنجاح"})]})}function ye({removeStd:t,closeConfirm:a}){return e.jsxs("div",{className:"absolute w-[300px] rounded  top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%] bg-white flex gap-8 flex-col p-4 border-2 border-bg-color shadow-md",children:[e.jsx("h1",{className:"text-bg-color font-semibold",children:"هل أنت متأكد من حذف هذا الطالب ؟"}),e.jsxs("div",{className:"flex justify-evenly",children:[e.jsx("span",{className:"block px-4 py-1 rounded cursor-pointer hover:bg-green-400 bg-green-800 text-white font-bold",onClick:()=>t(),children:"نعم"}),e.jsx("span",{className:"block px-4 py-1 rounded cursor-pointer hover:bg-red-400 bg-red-800 text-white font-bold",onClick:a,children:"لا"})]})]})}function Ne(t){return u({attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M6.2253 4.81108C5.83477 4.42056 5.20161 4.42056 4.81108 4.81108C4.42056 5.20161 4.42056 5.83477 4.81108 6.2253L10.5858 12L4.81114 17.7747C4.42062 18.1652 4.42062 18.7984 4.81114 19.1889C5.20167 19.5794 5.83483 19.5794 6.22535 19.1889L12 13.4142L17.7747 19.1889C18.1652 19.5794 18.7984 19.5794 19.1889 19.1889C19.5794 18.7984 19.5794 18.1652 19.1889 17.7747L13.4142 12L19.189 6.2253C19.5795 5.83477 19.5795 5.20161 19.189 4.81108C18.7985 4.42056 18.1653 4.42056 17.7748 4.81108L12 10.5858L6.2253 4.81108Z",fill:"currentColor"},child:[]}]})(t)}const Se=ie.memo(function({allUsers:a,pendingUsers:c,handelApproveUser:n,handelRejectUser:m,closePendingUsers:l}){return console.log("pending users rendering"),e.jsxs("div",{className:"absolute rounded  top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%] bg-n2-color text-white font-semibold w-90 min-h-40 flex justify-center shadow-md shadow-black",children:[e.jsx($,{size:50,color:"black",className:"absolute top-0 right-0 cursor-pointer hover:bg-red-500 transition-all duration-300 ease-in-out p-2 rounded",onClick:l}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsxs("div",{className:"flex flex-col py-2 items-center w-full bg-n-color",children:[e.jsx("p",{className:"mx-auto w-fit font-bold bg-p-color p-2 rounded",children:"الأدمن"}),a.length>0?a.map((i,x)=>e.jsx("div",{className:"flex items-center w-fit h-fit",children:e.jsxs("p",{className:"font-semibold text-lg text-bg-color",children:[++x,"- ",i==null?void 0:i.name]})},x)):e.jsx("p",{className:" relative text-p-color mx-auto",children:"لا يوجد حسابات "})]}),e.jsxs("div",{className:"flex flex-col py-2 items-center bg-s-color",children:[e.jsx("p",{className:"mx-auto w-fit font-bold bg-p-color p-2 rounded",children:"حسابات تنتظر التأكيد"}),c.length>0?c.map((i,x)=>e.jsxs("div",{className:"flex gap-2 mt-3 items-center justify-between w-fit h-fit",children:[e.jsx("p",{className:"font-semibold text-lg text-p-color",children:i==null?void 0:i.name}),e.jsx("p",{children:e.jsx(A,{size:35,color:"green",className:"p-2 bg-white rounded hover:bg-green-200 cursor-pointer",onClick:()=>n(i)})}),e.jsx("p",{children:e.jsx(Ne,{size:35,color:"red",className:"p-2 bg-white rounded hover:bg-red-200 cursor-pointer",onClick:()=>m(i.id)})})]},x)):e.jsx("p",{className:" relative top-5 mb-10 mx-auto",children:"لا يوجد حسابات تنتظر التأكيد"})]})]})]})});function ke(t){return u({attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M0.877014 7.49988C0.877014 3.84219 3.84216 0.877045 7.49985 0.877045C11.1575 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1575 14.1227 7.49985 14.1227C3.84216 14.1227 0.877014 11.1575 0.877014 7.49988ZM7.49985 1.82704C4.36683 1.82704 1.82701 4.36686 1.82701 7.49988C1.82701 8.97196 2.38774 10.3131 3.30727 11.3213C4.19074 9.94119 5.73818 9.02499 7.50023 9.02499C9.26206 9.02499 10.8093 9.94097 11.6929 11.3208C12.6121 10.3127 13.1727 8.97172 13.1727 7.49988C13.1727 4.36686 10.6328 1.82704 7.49985 1.82704ZM10.9818 11.9787C10.2839 10.7795 8.9857 9.97499 7.50023 9.97499C6.01458 9.97499 4.71624 10.7797 4.01845 11.9791C4.97952 12.7272 6.18765 13.1727 7.49985 13.1727C8.81227 13.1727 10.0206 12.727 10.9818 11.9787ZM5.14999 6.50487C5.14999 5.207 6.20212 4.15487 7.49999 4.15487C8.79786 4.15487 9.84999 5.207 9.84999 6.50487C9.84999 7.80274 8.79786 8.85487 7.49999 8.85487C6.20212 8.85487 5.14999 7.80274 5.14999 6.50487ZM7.49999 5.10487C6.72679 5.10487 6.09999 5.73167 6.09999 6.50487C6.09999 7.27807 6.72679 7.90487 7.49999 7.90487C8.27319 7.90487 8.89999 7.27807 8.89999 6.50487C8.89999 5.73167 8.27319 5.10487 7.49999 5.10487Z",fill:"currentColor"},child:[]}]})(t)}function ze(t){return u({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"},child:[]},{tag:"polyline",attr:{points:"13 2 13 9 20 9"},child:[]}]})(t)}function Ge(){const[t,a]=r.useState(!1),[c,n]=r.useState([]),[m,l]=r.useState(!1),[i,x]=r.useState(!1),[k,y]=r.useState([]),[v,z]=r.useState(!1),[j,g]=r.useState(!1),[L,f]=r.useState(""),[P,p]=r.useState(null),[M,N]=r.useState(null),[D,w]=r.useState([]),[E,Z]=r.useState([]),[q,O]=r.useState(""),W=ce();r.useEffect(()=>{I(),J(),re()},[]);const I=r.useCallback(async()=>{try{const s=G(h,"grades"),S=(await V(s)).docs.map(b=>({id:b.id,...b.data()})).sort((b,U)=>parseInt(b.std_id)-parseInt(U.std_id));n(S)}catch(s){console.log("the error is : "+s)}},[]),J=r.useCallback(async()=>{const o=T().currentUser;if(o){const d=C(h,"users",o.uid),S=await he(d);if(S.exists()){const b=S.data();O(b.name)}else console.log("no teacher")}try{const d=G(h,"users"),b=(await V(d)).docs.map(U=>({id:U.id,...U.data()}));Z(b)}catch(d){console.log(`all users error is : ${d}`)}},[]),K=async()=>{const s=T();try{await xe(s),W("/login")}catch(o){console.log(o)}};function Q(){a(!t)}const X=()=>{l(!0),w(null),N(null)},Y=()=>{l(!1),w(null),N(null)},ee=s=>{x(!0),p(s)},te=async s=>{try{console.log("removing"),await _(C(h,"grades",s)),n(o=>o.filter(d=>d.id!==s)),x(!1)}catch(o){console.log(`the Error while deleting is : ${o}`)}finally{g(!0),f("تم الحذف بنجاح"),setTimeout(()=>{g(!1),f("")},1500)}},se=async s=>{const o=c.find(d=>d.id==s);o&&(N(s),l(!0),w(o))},re=r.useCallback(async()=>{try{const o=(await V(G(h,"pending-users"))).docs.map(d=>({id:d.id,...d.data()}));y(o),console.log(`the pending users are ${k}`)}catch(s){console.log(`pending users error : ${s}`)}},[]),H=()=>{z(!v)},oe=r.useCallback(async s=>{try{await ue(C(h,"users",s.id),{name:s.name,email:s.email,approveAt:new Date}),await _(C(h,"pending-users",s.id)),y(o=>o.filter(d=>d.id!==s.id)),g(!0),f("تم القبول بنجاح"),setTimeout(()=>{g(!1),f("")},1500)}catch(o){console.log(`approve pending error is : ${o}`)}},[]),ae=r.useCallback(async s=>{try{await _(C(h,"pending-users",s)),g(!0),f("تم الرفض بنجاح"),setTimeout(()=>{g(!1),f("")},1500),y(o=>o.filter(d=>d.id!==s))}catch(o){console.log(`reject user Error is : ${o}`)}},[]),le=()=>{x(!1)};return e.jsxs("div",{className:"overflow-hidden bg-bg-color min-h-[100dvh]",children:[e.jsx("p",{className:"sr-only",children:"Dashboard"}),e.jsxs("header",{className:"flex justify-between items-center mb-5 px-dyp bg-gray-500",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(ke,{size:40,color:"beige",className:"hidden md:block"}),e.jsx("p",{className:"text-white font-bold self-center flex-wrap",children:q})]}),e.jsx("h1",{className:"text-2xl lg:text-4xl max-sm:basis-[160px] text-white font-bold py-5",children:"لوحة التحكم"}),e.jsxs("button",{className:"flex items-center gap-2 bg-white text-gray-800 hover:text-white hover:bg-p-color transition-all duration-300 ease-out px-2 py-1 md:px-3 md:py-2 rounded cursor-pointer font-bold",onClick:K,children:[e.jsx(fe,{size:30})," ",e.jsx("span",{className:"hidden md:block",children:"تسجيل خروج"})]})]}),e.jsxs("main",{className:"px-dyp py-10",role:"main",children:[e.jsxs("p",{className:"flex gap-3 items-center text-xl md:text-2xl lg:text-4xl mb-5 font-extrabold justify-center px-3 py-2 text-white",children:[e.jsx(ze,{size:40,color:"white"})," بيانات الطلاب"]}),e.jsx(we,{students:c,handelDelete:ee,handelEdit:se}),m&&e.jsx(Ce,{oldStudent:D,closeNewStdForm:Y,editedId:M,fetchStudents:I}),i&&e.jsx(ye,{removeStd:()=>te(P),closeConfirm:le}),j&&e.jsx("div",{className:"fixed bottom-[100px] left-[50px] w-[200px]",children:e.jsx(R,{msg:L})}),!m&&e.jsx(ge,{handleSidePanelArrow:Q,showSidePanel:t,showAllStudentsData:I,addNewStudent:X,showPendingUsers:H}),v&&e.jsx(e.Fragment,{children:e.jsx(Se,{pendingUsers:k,allUsers:E,handelApproveUser:oe,handelRejectUser:ae,closePendingUsers:H})})]})]})}export{Ge as default};
